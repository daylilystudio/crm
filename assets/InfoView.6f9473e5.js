import{d as O,i as R,A as L,b as K,O as H,r as D,e as Q,o as W,W as J,Y as X,f as p,K as G,L as N,k as e,p as a,l as r,w as o,j as d,g as y,v as C,x as P,F as S,m as g,h as A,s as B,a as Z,P as ee,Q as te,R as ae,S as le,T as oe,U as ne,V as ue}from"./index.b0b44b5a.js";import{d as se,f as q,o as j}from"./mixin.fa525c43.js";const de={key:0},re={key:0},ie={key:0},pe={key:0},me={key:0},ce={key:0},fe={key:0},_e={class:"text-right"},ye=O({__name:"InfoForm",props:{type:{type:String,default:"view"},id:{type:Number,default:0},path:{type:String,default:""}},emits:["toggleModal"],setup(U,{emit:b}){const m=U,t=R(L),_=K();H(()=>{se()});const c=D(),l=D({id:0,company:{id:null},username:"",name:"",dept:{id:null},applyDate:null,leaveDate:null,password:"",activation:!1}),h=Q(()=>({username:[{required:!0,message:"Enter \u4EE3\u865F",trigger:"blur"},{max:50,message:"\u6700\u5927\u9577\u5EA6\u70BA50",trigger:"blur"},{validator:j,trigger:"blur"}],name:[{required:!0,message:"Enter Name",trigger:"blur"},{max:30,message:"\u6700\u5927\u9577\u5EA6\u70BA30",trigger:"blur"}],applyDate:[{required:!0,message:"Please Choose",trigger:"change"}],company:{id:[{required:!0,message:"Please Choose",trigger:"change"}]},dept:{id:[{required:!0,message:"Please Choose",trigger:"change"}]},password:[{required:!0,min:8,max:20,message:"Enter \uFF0C\u9577\u5EA6\u4ECB\u65BC8~20",trigger:"blur"},{validator:j,trigger:"blur"}]})),s=D([]),F=D(0);return W(async()=>{if(m.id>0){const k=await _.dispatch("getModalData",{http:t,path:m.path,id:m.id});k&&(l.value=k.data)}_.state.company.length&&m.type!=="edit"&&(l.value.company.id=_.state.company[0].id),m.type!=="view"&&J(()=>l.value.company.id,k=>{F.value++;const u={companyId:k};t.get("/dept/info/option",{params:u}).then(v=>{s.value=v.data,(F.value!==1||m.type!=="edit")&&(l.value.dept.id=null)}).catch(v=>{X.error(v.toString())})},{immediate:!0})}),(k,u)=>{const v=p("el-input"),f=p("el-form-item"),Y=p("el-option"),V=p("el-select"),w=p("el-date-picker"),x=p("el-switch"),M=p("el-button"),z=p("el-form"),$=G("loading");return N((a(),r(z,{ref_key:"formRef",ref:c,model:l.value,rules:h.value,"label-width":"100px"},{default:o(()=>[d(f,{label:"\u4EBA\u54E1\u4EE3\u865F",prop:"username"},{default:o(()=>[m.type==="view"?(a(),y("label",de,C(l.value.username),1)):(a(),r(v,{key:1,modelValue:l.value.username,"onUpdate:modelValue":u[0]||(u[0]=i=>l.value.username=i),maxlength:"50",clearable:""},null,8,["modelValue"]))]),_:1}),d(f,{label:"\u4EBA\u54E1Name",prop:"name"},{default:o(()=>[m.type==="view"?(a(),y("label",re,C(l.value.name),1)):(a(),r(v,{key:1,modelValue:l.value.name,"onUpdate:modelValue":u[1]||(u[1]=i=>l.value.name=i),clearable:""},null,8,["modelValue"]))]),_:1}),e(_).state.user.superUser?(a(),r(f,{key:0,label:"\u6240\u5C6C\u516C\u53F8",prop:"company.id"},{default:o(()=>[m.type==="view"?(a(),y("label",ie,C(l.value.company.name),1)):(a(),r(V,{key:1,modelValue:l.value.company.id,"onUpdate:modelValue":u[2]||(u[2]=i=>l.value.company.id=i),placeholder:"Please Choose",filterable:""},{default:o(()=>[(a(!0),y(S,null,P(e(_).state.company,i=>(a(),r(Y,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1})):g("",!0),d(f,{label:"\u90E8\u9580",prop:"dept.id"},{default:o(()=>{var i;return[m.type==="view"?(a(),y("label",pe,C((i=l.value.dept)==null?void 0:i.name),1)):(a(),r(V,{key:1,modelValue:l.value.dept.id,"onUpdate:modelValue":u[3]||(u[3]=E=>l.value.dept.id=E),placeholder:"Please Choose",filterable:""},{default:o(()=>[(a(!0),y(S,null,P(s.value,E=>(a(),r(Y,{key:E.id,label:E.name,value:E.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]}),_:1}),d(f,{label:"\u5831\u8058\u65E5",prop:"applyDate"},{default:o(()=>[m.type==="view"?(a(),y("label",me,C(e(q)(l.value.applyDate)),1)):(a(),r(w,{key:1,modelValue:l.value.applyDate,"onUpdate:modelValue":u[4]||(u[4]=i=>l.value.applyDate=i),type:"date",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",placeholder:"Please Choose"},null,8,["modelValue"]))]),_:1}),d(f,{label:"\u96E2\u8077\u65E5",prop:"leaveDate"},{default:o(()=>[m.type==="view"?(a(),y("label",ce,C(e(q)(l.value.leaveDate)),1)):(a(),r(w,{key:1,modelValue:l.value.leaveDate,"onUpdate:modelValue":u[5]||(u[5]=i=>l.value.leaveDate=i),type:"date",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",placeholder:"Please Choose"},null,8,["modelValue"]))]),_:1}),m.type==="add"?(a(),r(f,{key:1,label:"\u5BC6\u78BC",prop:"password"},{default:o(()=>[d(v,{modelValue:l.value.password,"onUpdate:modelValue":u[6]||(u[6]=i=>l.value.password=i),type:"password",maxlength:"20",placeholder:"\u5BC6\u78BC",clearable:""},null,8,["modelValue"])]),_:1})):g("",!0),d(f,{label:"\u555F\u7528",prop:"activation"},{default:o(()=>[m.type==="view"?(a(),y("label",fe,C(l.value.activation?"\u662F":"\u5426"),1)):(a(),r(x,{key:1,modelValue:l.value.activation,"onUpdate:modelValue":u[7]||(u[7]=i=>l.value.activation=i),"active-text":"\u662F","inactive-text":"\u5426"},null,8,["modelValue"]))]),_:1}),A("div",_e,[d(M,{onClick:u[8]||(u[8]=i=>b("toggleModal",!1))},{default:o(()=>[B("Close")]),_:1}),m.type!=="view"?(a(),r(M,{key:0,type:"primary",onClick:u[9]||(u[9]=i=>e(_).dispatch("saveData",{http:e(t),path:U.path,form:l.value,ref:c.value}))},{default:o(()=>[B("Save")]),_:1})):g("",!0)])]),_:1},8,["model","rules"])),[[$,e(_).state.progressing]])}}}),ge=A("div",{class:"card-header"},"Search Filter",-1),ve={class:"grid sm:gap-x-8 sm:grid-cols-2"},be={class:"card-header flex justify-between items-center"},he=A("span",null,"Result",-1),Ee=O({__name:"InfoView",setup(U){const b=R(L),m=Z(),t=K(),_=D(m.path),c=ee({username:"",name:"",company:{id:null}});W(async()=>{await t.dispatch("getCompany",{http:b}),t.state.company.length&&(c.company.id=Number(t.state.user.companyId))});const l=Q(()=>{const h={page:t.state.page,pageSize:t.state.pageSize};return c.username.length>0&&(h.username=c.username),c.name.length>0&&(h.name=c.name),c.company.id>0&&(h.companyId=c.company.id),h});return(h,s)=>{const F=p("el-option"),k=p("el-select"),u=p("el-form-item"),v=p("el-input"),f=p("el-button"),Y=p("el-form"),V=p("el-card"),w=p("el-table-column"),x=p("el-tooltip"),M=p("el-button-group"),z=p("el-table"),$=p("el-pagination"),i=p("el-space"),E=p("el-dialog"),I=G("loading");return a(),y(S,null,[d(i,{size:20,fill:!0,class:"w-full px-4"},{default:o(()=>[N((a(),r(V,{class:"box-card"},{header:o(()=>[ge]),default:o(()=>[d(Y,{"label-position":"left"},{default:o(()=>[A("div",ve,[e(t).state.user.superUser?(a(),r(u,{key:0,label:"\u6240\u5C6C\u516C\u53F8",prop:"company.id"},{default:o(()=>[d(k,{modelValue:c.company.id,"onUpdate:modelValue":s[0]||(s[0]=n=>c.company.id=n),placeholder:"Please Choose",filterable:""},{default:o(()=>[(a(!0),y(S,null,P(e(t).state.company,n=>(a(),r(F,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):g("",!0),d(u,{label:"\u4EBA\u54E1\u4EE3\u865F",prop:"username"},{default:o(()=>[d(v,{modelValue:c.username,"onUpdate:modelValue":s[1]||(s[1]=n=>c.username=n),placeholder:"Enter \u4EBA\u54E1\u4EE3\u865F",maxlength:"50",clearable:""},null,8,["modelValue"])]),_:1}),d(u,{label:"\u4EBA\u54E1Name",prop:"name"},{default:o(()=>[d(v,{modelValue:c.name,"onUpdate:modelValue":s[2]||(s[2]=n=>c.name=n),placeholder:"Enter \u4EBA\u54E1Name",clearable:""},null,8,["modelValue"])]),_:1})]),e(t).state.show.read?(a(),r(f,{key:0,icon:e(te),type:"primary",onClick:s[3]||(s[3]=n=>e(t).dispatch("getData",{http:e(b),path:_.value,data:l.value})),class:"!flex w-full sm:w-56 mx-auto"},{default:o(()=>[B("Search")]),_:1},8,["icon"])):g("",!0)]),_:1})]),_:1})),[[I,e(t).state.progressing]]),N((a(),r(V,{class:"box-card"},{header:o(()=>[A("div",be,[he,e(t).state.show.create?(a(),r(f,{key:0,onClick:s[4]||(s[4]=n=>e(t).dispatch("action",{type:"add",id:0})),icon:e(ae),type:"primary",plain:""},{default:o(()=>[B("Add\u4EBA\u54E1")]),_:1},8,["icon"])):g("",!0)])]),default:o(()=>[d(z,{data:e(t).state.table,flexible:!0,border:""},{default:o(()=>[d(w,{prop:"username",label:"\u4EBA\u54E1\u4EE3\u865F"}),d(w,{prop:"name",label:"\u4EBA\u54E1Name"}),d(w,{prop:"dept.name",label:"\u90E8\u9580"}),d(w,{label:"Operate",fixed:"right",width:"150",align:"center"},{default:o(n=>[d(M,null,{default:o(()=>[e(t).state.show.detail?g("",!0):(a(),r(f,{key:0,icon:e(le),round:"",disabled:""},{default:o(()=>[B("\u7121\u6B0A\u9650")]),_:1},8,["icon"])),e(t).state.show.detail?(a(),r(x,{key:1,class:"box-item",effect:"dark",content:"\u700F\u89BD",placement:"top","hide-after":0},{default:o(()=>[d(f,{onClick:T=>e(t).dispatch("action",{type:"view",id:n.row.id}),icon:e(oe)},null,8,["onClick","icon"])]),_:2},1024)):g("",!0),e(t).state.show.update?(a(),r(x,{key:2,class:"box-item",effect:"dark",content:"\u7DE8\u8F2F",placement:"top","hide-after":0},{default:o(()=>[d(f,{onClick:T=>e(t).dispatch("action",{type:"edit",id:n.row.id}),icon:e(ne)},null,8,["onClick","icon"])]),_:2},1024)):g("",!0),e(t).state.show.delete?(a(),r(x,{key:3,class:"box-item",effect:"dark",content:"\u522A\u9664",placement:"top","hide-after":0},{default:o(()=>[d(f,{onClick:T=>e(t).dispatch("handleDelete",{http:e(b),path:_.value,data:l.value,row:n.row}),icon:e(ue),type:"danger",plain:""},null,8,["onClick","icon"])]),_:2},1024)):g("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"]),e(t).state.table.length>0?(a(),r($,{key:0,onSizeChange:s[5]||(s[5]=n=>e(t).dispatch("handleSizeChange",{http:e(b),path:_.value,data:l.value,val:n})),onCurrentChange:s[6]||(s[6]=n=>e(t).dispatch("handleCurrentChange",{http:e(b),path:_.value,data:l.value,val:n})),"current-page":e(t).state.page,"onUpdate:currentPage":s[7]||(s[7]=n=>e(t).state.page=n),"page-size":e(t).state.pageSize,"onUpdate:pageSize":s[8]||(s[8]=n=>e(t).state.pageSize=n),"page-sizes":[10,25,50,100],total:e(t).state.total,layout:"total, sizes, prev, pager, next",class:"flex flex-wrap justify-center mt-4"},null,8,["current-page","page-size","total"])):g("",!0)]),_:1})),[[I,e(t).state.progressing]])]),_:1}),d(E,{modelValue:e(t).state.modalOpen,"onUpdate:modelValue":s[10]||(s[10]=n=>e(t).state.modalOpen=n),title:e(t).getters.actionTitle,"append-to-body":!0,"close-on-click-modal":!1,width:"95%",style:{"max-width":"600px"}},{default:o(()=>[(a(),r(ye,{key:e(t).state.actionType+e(t).state.actionId,onToggleModal:s[9]||(s[9]=n=>e(t).commit("updateModalOpen",n)),type:e(t).state.actionType,id:e(t).state.actionId,path:_.value},null,8,["type","id","path"]))]),_:1},8,["modelValue","title"])],64)}}});export{Ee as default};
