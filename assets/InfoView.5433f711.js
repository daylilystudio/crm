import{d as L,i as K,A as W,b as Q,O as X,r as D,e as G,o as H,W as j,Y as N,f as m,K as J,L as T,k as a,p as t,l as d,w as o,g,v as k,x as B,F as A,m as w,j as u,h as U,s as S,a as Z,P as ee,Q as ae,R as te,S as le,T as oe,U as ue,V as ne}from"./index.b0b44b5a.js";import{d as se,f as O,o as de}from"./mixin.fa525c43.js";import{A as M}from"./AddItem.df142259.js";import"./plugin-vueexport-helper.2444895f.js";const re={key:0},ie={key:0},pe={key:0},me={key:0},ce={key:0},fe={key:0},ye={key:0},ve={key:0},_e={key:0},ge={key:0},be={class:"text-right"},he=L({__name:"InfoForm",props:{type:{type:String,default:"view"},id:{type:Number,default:0},path:{type:String,default:""}},emits:["toggleModal"],setup(P,{emit:C}){const i=P,l=K(W),b=Q();X(()=>{se()});const v=D(),e=D({id:0,code:"",name:"",address:"",establishDate:"",writeoffDate:null,remark:"",company:{id:null},type:{id:null},upper:{id:null},principal:{id:null},webItems:[],emailItems:[],phoneItems:[],faxItems:[]}),E=G(()=>({code:[{required:!0,message:"Enter  ID",trigger:"blur"},{max:20,message:"\u6700\u5927\u9577\u5EA6\u70BA20",trigger:"blur"},{validator:de,trigger:"blur"}],name:[{required:!0,message:"Enter Name",trigger:"blur"},{max:50,message:"\u6700\u5927\u9577\u5EA6\u70BA50",trigger:"blur"}],address:[{required:!0,message:"Enter Address",trigger:"blur"},{max:255,message:"\u6700\u5927\u9577\u5EA6\u70BA255",trigger:"blur"}],establishDate:[{required:!0,message:"Please Choose",trigger:"change"}],company:{id:[{required:!0,message:"Please Choose",trigger:"change"}]},type:{id:[{required:!0,message:"Please Choose",trigger:"change"}]}})),p=D([]),I=D([]),F=D([]);return H(async()=>{if(i.id>0){const h=await b.dispatch("getModalData",{http:l,path:i.path,id:i.id});h&&(e.value=h.data)}if(b.state.company.length&&i.type!=="edit"&&(e.value.company.id=b.state.company[0].id),i.type!=="view"){j(()=>e.value.company.id,n=>{i.type==="add"&&(e.value.type.id=null,e.value.principal.id=null);const _={companyId:n};l.get("/dept/type/option",{params:_}).then(f=>{p.value=f.data}).catch(f=>{N.error(f.toString())}),l.get("/personnel/info/option",{params:_}).then(f=>{F.value=f.data}).catch(f=>{N.error(f.toString())})},{immediate:!0});const h=D(0);j(()=>e.value.type.id,n=>{h.value++;const _={companyId:e.value.company.id,overDeptTypeId:n};n!==null?l.get("/dept/info/option",{params:_}).then(f=>{I.value=f.data,(h.value!==1||i.type!=="edit")&&(e.value.upper.id=null)}).catch(f=>{N.error(f.toString())}):I.value=[]},{immediate:!0})}}),(h,n)=>{const _=m("el-option"),f=m("el-select"),y=m("el-form-item"),V=m("el-input"),x=m("el-date-picker"),Y=m("el-button"),z=m("el-form"),$=J("loading");return T((t(),d(z,{ref_key:"formRef",ref:v,model:e.value,rules:E.value,"label-width":"100px"},{default:o(()=>[a(b).state.user.superUser?(t(),d(y,{key:0,label:"\u6240\u5C6C\u516C\u53F8",prop:"company.id"},{default:o(()=>[i.type==="view"?(t(),g("label",re,k(e.value.company.name),1)):(t(),d(f,{key:1,modelValue:e.value.company.id,"onUpdate:modelValue":n[0]||(n[0]=s=>e.value.company.id=s),disabled:i.type==="edit",placeholder:"Please Choose",filterable:""},{default:o(()=>[(t(!0),g(A,null,B(a(b).state.company,s=>(t(),d(_,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]))]),_:1})):w("",!0),u(y,{label:"\u90E8\u9580\u985E\u5225",prop:"type.id"},{default:o(()=>{var s;return[i.type==="view"?(t(),g("label",ie,k((s=e.value.type)==null?void 0:s.name),1)):(t(),d(f,{key:1,modelValue:e.value.type.id,"onUpdate:modelValue":n[1]||(n[1]=c=>e.value.type.id=c),placeholder:"Please Choose",filterable:""},{default:o(()=>[(t(!0),g(A,null,B(p.value,c=>(t(),d(_,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]}),_:1}),u(y,{label:"\u4E0A\u4F4D\u90E8\u9580",prop:"dept.id"},{default:o(()=>{var s;return[i.type==="view"?(t(),g("label",pe,k((s=e.value.upper)==null?void 0:s.name),1)):(t(),d(f,{key:1,modelValue:e.value.upper.id,"onUpdate:modelValue":n[2]||(n[2]=c=>e.value.upper.id=c),placeholder:"Please Choose",filterable:""},{default:o(()=>[(t(!0),g(A,null,B(I.value,c=>(t(),d(_,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]}),_:1}),u(y,{label:"\u8CA0\u8CAC\u4EBA",prop:"principal.id"},{default:o(()=>{var s;return[i.type==="view"?(t(),g("label",me,k((s=e.value.principal)==null?void 0:s.name),1)):(t(),d(f,{key:1,modelValue:e.value.principal.id,"onUpdate:modelValue":n[3]||(n[3]=c=>e.value.principal.id=c),placeholder:"Please Choose",filterable:""},{default:o(()=>[(t(!0),g(A,null,B(F.value,c=>(t(),d(_,{key:c.id,label:c.name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]}),_:1}),u(y,{label:"\u90E8\u9580\u4EE3\u865F",prop:"code"},{default:o(()=>[i.type==="view"?(t(),g("label",ce,k(e.value.code),1)):(t(),d(V,{key:1,modelValue:e.value.code,"onUpdate:modelValue":n[4]||(n[4]=s=>e.value.code=s),maxlength:"20",clearable:""},null,8,["modelValue"]))]),_:1}),u(y,{label:"\u90E8\u9580Name",prop:"name"},{default:o(()=>[i.type==="view"?(t(),g("label",fe,k(e.value.name),1)):(t(),d(V,{key:1,modelValue:e.value.name,"onUpdate:modelValue":n[5]||(n[5]=s=>e.value.name=s),clearable:""},null,8,["modelValue"]))]),_:1}),u(y,{label:"\u90E8\u9580Address",prop:"address"},{default:o(()=>[i.type==="view"?(t(),g("label",ye,k(e.value.address),1)):(t(),d(V,{key:1,modelValue:e.value.address,"onUpdate:modelValue":n[6]||(n[6]=s=>e.value.address=s),clearable:""},null,8,["modelValue"]))]),_:1}),u(y,{label:"\u6210\u7ACB\u65E5\u671F",prop:"establishDate"},{default:o(()=>[i.type==="view"?(t(),g("label",ve,k(a(O)(e.value.establishDate)),1)):(t(),d(x,{key:1,modelValue:e.value.establishDate,"onUpdate:modelValue":n[7]||(n[7]=s=>e.value.establishDate=s),type:"date",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",placeholder:"Please Choose"},null,8,["modelValue"]))]),_:1}),u(y,{label:"\u8A3B\u92B7\u65E5\u671F",prop:"writeoffDate"},{default:o(()=>[i.type==="view"?(t(),g("label",_e,k(a(O)(e.value.writeoffDate)),1)):(t(),d(x,{key:1,modelValue:e.value.writeoffDate,"onUpdate:modelValue":n[8]||(n[8]=s=>e.value.writeoffDate=s),type:"date",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",placeholder:"Please Choose"},null,8,["modelValue"]))]),_:1}),u(y,{label:"Remark",prop:"remark"},{default:o(()=>[i.type==="view"?(t(),g("label",ge,k(e.value.remark),1)):(t(),d(V,{key:1,modelValue:e.value.remark,"onUpdate:modelValue":n[9]||(n[9]=s=>e.value.remark=s),clearable:""},null,8,["modelValue"]))]),_:1}),u(y,{label:"\u90E8\u9580\u7DB2\u7AD9"},{default:o(()=>[u(M,{arrays:e.value.webItems,"label-title":"\u7DB2\u5740","can-save":i.type!=="view",ref:"web"},null,8,["arrays","can-save"])]),_:1}),u(y,{label:"\u90E8\u9580Email"},{default:o(()=>[u(M,{arrays:e.value.emailItems,"label-title":"Email","can-save":i.type!=="view",keyWord:"email",ref:"email"},null,8,["arrays","can-save"])]),_:1}),u(y,{label:"\u90E8\u9580Phone"},{default:o(()=>[u(M,{arrays:e.value.phoneItems,"label-title":"Phone","can-save":i.type!=="view",ref:"phone"},null,8,["arrays","can-save"])]),_:1}),u(y,{label:"\u90E8\u9580\u50B3\u771F"},{default:o(()=>[u(M,{arrays:e.value.faxItems,"label-title":"\u50B3\u771F","can-save":i.type!=="view",ref:"fax"},null,8,["arrays","can-save"])]),_:1}),U("div",be,[u(Y,{onClick:n[10]||(n[10]=s=>C("toggleModal",!1))},{default:o(()=>[S("Close")]),_:1}),i.type!=="view"?(t(),d(Y,{key:0,type:"primary",onClick:n[11]||(n[11]=s=>a(b).dispatch("saveData",{http:a(l),path:P.path,form:e.value,ref:v.value}))},{default:o(()=>[S("Save")]),_:1})):w("",!0)])]),_:1},8,["model","rules"])),[[$,a(b).state.progressing]])}}}),ke=U("div",{class:"card-header"},"Search Filter",-1),we={class:"grid sm:gap-x-8 sm:grid-cols-2"},Ve={class:"card-header flex justify-between items-center"},Ce=U("span",null,"Result",-1),Ie=L({__name:"InfoView",setup(P){const C=K(W),i=Z(),l=Q(),b=D(i.path),v=ee({code:"",name:"",company:{id:null}});H(async()=>{await l.dispatch("getCompany",{http:C}),l.state.company.length&&(v.company.id=Number(l.state.user.companyId))});const e=G(()=>{const E={page:l.state.page,pageSize:l.state.pageSize};return v.code.length>0&&(E.code=v.code),v.name.length>0&&(E.name=v.name),v.company.id>0&&(E.companyId=v.company.id),E});return(E,p)=>{const I=m("el-option"),F=m("el-select"),h=m("el-form-item"),n=m("el-input"),_=m("el-button"),f=m("el-form"),y=m("el-card"),V=m("el-table-column"),x=m("el-tooltip"),Y=m("el-button-group"),z=m("el-table"),$=m("el-pagination"),s=m("el-space"),c=m("el-dialog"),q=J("loading");return t(),g(A,null,[u(s,{size:20,fill:!0,class:"w-full px-4"},{default:o(()=>[T((t(),d(y,{class:"box-card"},{header:o(()=>[ke]),default:o(()=>[u(f,{"label-position":"left"},{default:o(()=>[U("div",we,[a(l).state.user.superUser?(t(),d(h,{key:0,label:"\u6240\u5C6C\u516C\u53F8",prop:"company.id"},{default:o(()=>[u(F,{modelValue:v.company.id,"onUpdate:modelValue":p[0]||(p[0]=r=>v.company.id=r),placeholder:"Please Choose",filterable:""},{default:o(()=>[(t(!0),g(A,null,B(a(l).state.company,r=>(t(),d(I,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):w("",!0),u(h,{label:"\u90E8\u9580\u4EE3\u865F",prop:"code"},{default:o(()=>[u(n,{modelValue:v.code,"onUpdate:modelValue":p[1]||(p[1]=r=>v.code=r),placeholder:"Enter \u90E8\u9580\u4EE3\u865F",maxlength:"20",clearable:""},null,8,["modelValue"])]),_:1}),u(h,{label:"\u90E8\u9580Name",prop:"name"},{default:o(()=>[u(n,{modelValue:v.name,"onUpdate:modelValue":p[2]||(p[2]=r=>v.name=r),placeholder:"Enter \u90E8\u9580Name",clearable:""},null,8,["modelValue"])]),_:1})]),a(l).state.show.read?(t(),d(_,{key:0,icon:a(ae),type:"primary",onClick:p[3]||(p[3]=r=>a(l).dispatch("getData",{http:a(C),path:b.value,data:e.value})),class:"!flex w-full sm:w-56 mx-auto"},{default:o(()=>[S("Search")]),_:1},8,["icon"])):w("",!0)]),_:1})]),_:1})),[[q,a(l).state.progressing]]),T((t(),d(y,{class:"box-card"},{header:o(()=>[U("div",Ve,[Ce,a(l).state.show.create?(t(),d(_,{key:0,onClick:p[4]||(p[4]=r=>a(l).dispatch("action",{type:"add",id:0})),icon:a(te),type:"primary",plain:""},{default:o(()=>[S("Add\u90E8\u9580")]),_:1},8,["icon"])):w("",!0)])]),default:o(()=>[u(z,{data:a(l).state.table,flexible:!0,border:""},{default:o(()=>[u(V,{prop:"code",label:"\u90E8\u9580 ID"}),u(V,{prop:"name",label:"\u90E8\u9580Name"}),u(V,{prop:"principal.name",label:"\u8CA0\u8CAC\u4EBA"}),u(V,{label:"Operate",fixed:"right",width:"150",align:"center"},{default:o(r=>[u(Y,null,{default:o(()=>[a(l).state.show.detail?w("",!0):(t(),d(_,{key:0,icon:a(le),round:"",disabled:""},{default:o(()=>[S("\u7121\u6B0A\u9650")]),_:1},8,["icon"])),a(l).state.show.detail?(t(),d(x,{key:1,class:"box-item",effect:"dark",content:"\u700F\u89BD",placement:"top","hide-after":0},{default:o(()=>[u(_,{onClick:R=>a(l).dispatch("action",{type:"view",id:r.row.id}),icon:a(oe)},null,8,["onClick","icon"])]),_:2},1024)):w("",!0),a(l).state.show.update?(t(),d(x,{key:2,class:"box-item",effect:"dark",content:"\u7DE8\u8F2F",placement:"top","hide-after":0},{default:o(()=>[u(_,{onClick:R=>a(l).dispatch("action",{type:"edit",id:r.row.id}),icon:a(ue)},null,8,["onClick","icon"])]),_:2},1024)):w("",!0),a(l).state.show.delete?(t(),d(x,{key:3,class:"box-item",effect:"dark",content:"\u522A\u9664",placement:"top","hide-after":0},{default:o(()=>[u(_,{onClick:R=>a(l).dispatch("handleDelete",{http:a(C),path:b.value,data:e.value,row:r.row}),icon:a(ne),type:"danger",plain:""},null,8,["onClick","icon"])]),_:2},1024)):w("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"]),a(l).state.table.length>0?(t(),d($,{key:0,onSizeChange:p[5]||(p[5]=r=>a(l).dispatch("handleSizeChange",{http:a(C),path:b.value,data:e.value,val:r})),onCurrentChange:p[6]||(p[6]=r=>a(l).dispatch("handleCurrentChange",{http:a(C),path:b.value,data:e.value,val:r})),"current-page":a(l).state.page,"onUpdate:currentPage":p[7]||(p[7]=r=>a(l).state.page=r),"page-size":a(l).state.pageSize,"onUpdate:pageSize":p[8]||(p[8]=r=>a(l).state.pageSize=r),"page-sizes":[10,25,50,100],total:a(l).state.total,layout:"total, sizes, prev, pager, next",class:"flex flex-wrap justify-center mt-4"},null,8,["current-page","page-size","total"])):w("",!0)]),_:1})),[[q,a(l).state.progressing]])]),_:1}),u(c,{modelValue:a(l).state.modalOpen,"onUpdate:modelValue":p[10]||(p[10]=r=>a(l).state.modalOpen=r),title:a(l).getters.actionTitle,"append-to-body":!0,"close-on-click-modal":!1,width:"95%",style:{"max-width":"600px"}},{default:o(()=>[(t(),d(he,{key:a(l).state.actionType+a(l).state.actionId,onToggleModal:p[9]||(p[9]=r=>a(l).commit("updateModalOpen",r)),type:a(l).state.actionType,id:a(l).state.actionId,path:b.value},null,8,["type","id","path"]))]),_:1},8,["modelValue","title"])],64)}}});export{Ie as default};
