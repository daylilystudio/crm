import{d as M,i as L,b as R,a as T,r as v,f as r,K as U,l as u,w as t,A as j,p as d,L as P,k as g,j as o,g as V,x as k,F as D,s as _,M as q,N as E,h as N,v as A}from"./index.b0b44b5a.js";import{f as $,o as z}from"./mixin.fa525c43.js";const I=N("div",{class:"card-header"},"Information",-1),O=N("div",{class:"card-header"},"Change Password",-1),J=M({__name:"ProFile",setup(Y){const w=L(j),i=R(),C=T(),p=v([]);i.commit("updateProgressing",!0),w.get("/profile").then(s=>{i.commit("updateProgressing",!1),p.value.push({title:"Number",val:s.data.username},{title:"Name",val:s.data.name},{title:"Company",val:s.data.company.name},{title:"Department",val:s.data.dept.name},{title:"Entry Date",val:$(s.data.applyDate)})}).catch(()=>{i.commit("updateProgressing",!1),p.value=[{title:"Number",val:"1111"},{title:"Name",val:"Test"},{title:"Company",val:"Test Company"},{title:"Department",val:"Marketing"}]});const m=v(),l=v({id:C.params.id,old:"",password:"",passwordAgain:""}),F=(s,e,n)=>{e===l.value.password?n():n(new Error("Password must be the same"))},b=async s=>{!s||await s.validate(e=>{if(e){const n={newPassword:l.value.password,oldPassword:l.value.old};i.dispatch("changePassword",{http:w,data:n})}})};return(s,e)=>{const n=r("el-descriptions-item"),x=r("el-descriptions"),y=r("el-card"),c=r("el-input"),f=r("el-form-item"),S=r("el-button"),B=r("el-form"),K=r("el-space"),h=U("loading");return d(),u(K,{size:20,fill:!0,class:"w-full px-4"},{default:t(()=>[P((d(),u(y,{class:"box-card"},{header:t(()=>[I]),default:t(()=>[o(x,{class:"hidden sm:block",column:2,border:""},{default:t(()=>[(d(!0),V(D,null,k(p.value,a=>(d(),u(n,{key:a,label:a.title},{default:t(()=>[_(A(a.val),1)]),_:2},1032,["label"]))),128))]),_:1}),o(x,{class:"block sm:hidden",column:1,border:"",direction:"vertical"},{default:t(()=>[(d(!0),V(D,null,k(p.value,a=>(d(),u(n,{key:a,label:a.title},{default:t(()=>[_(A(a.val),1)]),_:2},1032,["label"]))),128))]),_:1})]),_:1})),[[h,g(i).state.progressing]]),P((d(),u(y,{class:"box-card"},{header:t(()=>[O]),default:t(()=>[o(B,{onKeyup:e[4]||(e[4]=q(a=>b(m.value),["enter"])),model:l.value,ref_key:"passwordFormRef",ref:m,class:"flex flex-col sm:flex-row sm:gap-4",onSubmit:e[5]||(e[5]=E(()=>{},["prevent"]))},{default:t(()=>[o(f,{prop:"old",class:"flex-1"},{default:t(()=>[o(c,{type:"password",modelValue:l.value.old,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.old=a),maxlength:"20",placeholder:"Old Password",clearable:""},null,8,["modelValue"])]),_:1}),o(f,{prop:"password",rules:[{required:!0,min:8,max:20,message:"length between 8-12",trigger:"blur"},{validator:g(z),trigger:"blur"}],class:"flex-1"},{default:t(()=>[o(c,{type:"password",modelValue:l.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.password=a),maxlength:"20",placeholder:"New Password",clearable:""},null,8,["modelValue"])]),_:1},8,["rules"]),o(f,{prop:"passwordAgain",rules:[{required:!0,min:8,max:20,message:"length between 8-12",trigger:"blur"},{validator:F,trigger:"blur"}],class:"flex-1"},{default:t(()=>[o(c,{type:"password",modelValue:l.value.passwordAgain,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.passwordAgain=a),maxlength:"20",placeholder:"New Password Again",clearable:""},null,8,["modelValue"])]),_:1},8,["rules"]),o(S,{onClick:e[3]||(e[3]=a=>b(m.value)),type:"primary",class:"!block ml-auto"},{default:t(()=>[_("Save")]),_:1})]),_:1},8,["model"])]),_:1})),[[h,g(i).state.progressing]])]),_:1})}}});export{J as default};
