import{d as q,u as G,a as J,i as K,b as W,r as k,o as O,c as X,e as Y,f as l,g as y,h as g,j as o,w as t,n as z,k as c,l as v,m as B,F as C,A as Z,p as n,q as ee,s as d,t as te,v as b,x as E,y as ae,z as oe,B as le,C as se,D as ne,E as ue,G as re,H as ie,I as ce,J as de}from"./index.f9e09ed2.js";import{_ as me}from"./_plugin-vue_export-helper.cdc0426e.js";const pe=x=>(oe("data-v-26bab1c4"),x=x(),le(),x),_e={class:"fixed w-full top-0 left-0 z-50",style:{"background-image":"radial-gradient(transparent 1px,var(--el-bg-color) 1px)","background-size":"4px 4px","backdrop-filter":"saturate(50%) blur(4px)"}},fe=pe(()=>g("div",{class:"flex-grow"},null,-1)),ve=q({__name:"LayoutManage",setup(x){const p=G(),N=J(),I=K(Z),a=W(),r=k(!1),_=k(),m=k(),f=k("");O(()=>{w.value.length!==0&&(f.value=N.path,S(f.value))}),X(u=>{f.value=u.path,S(f.value),a.commit("updatePage",1),a.commit("updatePageSize",10),a.commit("updateTable",[]),a.commit("updatePageQ",1),a.commit("updatePageSizeQ",10),a.commit("updateTableQ",[])});const S=u=>{const e=u.split("/");e.shift(),e.length>1&&(e[0]==="profile"?(_.value={Name:"Personal Information",Code:"",Index:"",Patten:[]},m.value=""):(_.value=w.value.filter(i=>i.Code===e[0])[0],m.value=_.value.Patten.filter(i=>i.Code===e[1])[0]),L())},L=()=>{const u={create:!1,read:!1,delete:!1,update:!1,detail:!1,roleUpdate:!1,roleDetail:!1,assign:!1};m.value!==""&&m.value.Permission.forEach(e=>{u[e]=!0}),a.commit("updateShow",u)},w=Y(()=>a.state.user.permission.Block),A=()=>{I.defaults.headers.common.Authorization="",a.dispatch("login",{authToken:"",user:{permission:{Block:[]}}}),p.push("/login")},M=()=>{window.innerWidth<640&&(r.value=!0)};p.beforeEach(()=>{a.commit("updateProgressing",!0)}),p.afterEach(()=>{a.commit("updateProgressing",!1)});const D={company:se,dept:ne,personnel:ue,role:re,permission:ie,customer:ce,system:de};return(u,e)=>{const i=l("el-button"),R=l("router-link"),T=l("el-button-group"),$=l("el-menu"),V=l("el-menu-item"),Q=l("el-sub-menu"),j=l("el-scrollbar"),P=l("el-breadcrumb-item"),F=l("el-breadcrumb"),H=l("router-view"),U=l("el-empty");return n(),y(C,null,[g("nav",_e,[o($,{class:"items-center h-14",mode:"horizontal","background-color":"rgba(0,0,0,.08)",router:!0,ellipsis:!1},{default:t(()=>[o(i,{onClick:e[0]||(e[0]=s=>r.value=!r.value),icon:c(ee),class:"mx-2 !px-2 sm:!px-3",title:"Menu",type:"info",plain:"",round:""},null,8,["icon"]),o(R,{to:"/",class:"flex items-center text-sm sm:text-base"},{default:t(()=>[d("Partner CRM")]),_:1}),fe,o(T,{class:"mr-16"},{default:t(()=>[o(i,{onClick:e[1]||(e[1]=s=>{c(p).push("/profile/"+c(a).state.user.id),M()}),icon:c(te),title:"view profile",plain:"",round:""},{default:t(()=>[d(b(c(a).state.user.username),1)]),_:1},8,["icon"]),o(i,{onClick:e[2]||(e[2]=s=>A()),plain:"",round:""},{default:t(()=>[d("Logout")]),_:1})]),_:1})]),_:1})]),o(j,{class:z([r.value?"-translate-x-full":"translate-x-0","sidebar !fixed top-14 bottom-0 left-0 !overflow-y-auto z-20 duration-300"]),style:{"background-color":"var(--el-bg-color)",height:"auto"}},{default:t(()=>[o($,{size:"large","default-active":"2",class:"el-menu-vertical w-64"},{default:t(()=>[(n(!0),y(C,null,E(w.value,s=>(n(),v(Q,{index:s.Index,key:s.Code},{title:t(()=>[(n(),v(ae(D[s.Code]),{class:"w-4 mr-1 !text-gray-400"})),d(b(s.Name),1)]),default:t(()=>[(n(!0),y(C,null,E(s.Patten,h=>(n(),v(V,{onClick:be=>{c(p).push(`/${s.Code}/${h.Code}`),M()},index:h.Index,key:"children_"+h.Code},{default:t(()=>[g("a",null,b(h.Name),1)]),_:2},1032,["onClick","index"]))),128))]),_:2},1032,["index"]))),128))]),_:1})]),_:1},8,["class"]),g("div",{onClick:e[3]||(e[3]=s=>r.value=!0),class:z(["el-loading-mask !fixed !z-10 sm:hidden",{hidden:r.value}])},null,2),g("main",{class:z(["pb-8 pt-14 w-full h-full duration-300",{"sm:pl-64":!r.value}])},[o(F,{separator:"/",class:"mt-3 mb-6 px-4"},{default:t(()=>[o(P,{to:{path:"/"}},{default:t(()=>[d("Home")]),_:1}),f.value!=="/"&&_.value?(n(),y(C,{key:0},[o(P,null,{default:t(()=>[d(b(_.value.Name),1)]),_:1}),m.value?(n(),v(P,{key:0},{default:t(()=>[d(b(m.value.Name),1)]),_:1})):B("",!0)],64)):B("",!0)]),_:1}),o(H),c(N).path==="/"?(n(),v(U,{key:0,description:"\u21E0 click the function you want to use"})):B("",!0)],2)],64)}}});const he=me(ve,[["__scopeId","data-v-26bab1c4"]]);export{he as default};
